<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel Admin - Gest√£o de Vendas</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    
    <style>
        :root {
            --primary: #e67e22;
            --dark: #111;
            --gray: #f4f4f4;
            --success: #28a745;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background: #f8f9fa; color: #333; padding: 20px; }

        .admin-container { max-width: 1000px; margin: 0 auto; }

        /* Header do Painel */
        .admin-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 30px; 
            background: var(--dark); 
            color: #fff; 
            padding: 20px; 
            border-radius: 15px;
        }

        /* Cards de Resumo */
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .card { 
            background: #fff; 
            padding: 20px; 
            border-radius: 15px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); 
        }
        .card h4 { font-size: 0.8rem; text-transform: uppercase; color: #777; margin-bottom: 10px; }
        .card p { font-size: 1.5rem; font-weight: 800; color: var(--dark); }
        .card .highlight { color: var(--primary); }

        /* Tabela de Pedidos */
        .table-container { 
            background: #fff; 
            border-radius: 15px; 
            overflow: hidden; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); 
        }
        table { width: 100%; border-collapse: collapse; text-align: left; }
        thead { background: var(--gray); }
        th, td { padding: 15px 20px; border-bottom: 1px solid #eee; font-size: 0.9rem; }
        
        /* Bot√µes */
        .btn-pdf { 
            background: var(--success); 
            color: white; 
            border: none; 
            padding: 12px 20px; 
            border-radius: 10px; 
            font-weight: 600; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            gap: 10px;
        }
        .btn-pdf:hover { opacity: 0.9; }

        .status-badge { 
            padding: 5px 10px; 
            border-radius: 20px; 
            font-size: 0.75rem; 
            font-weight: 700; 
            background: #e1f5fe; 
            color: #01579b; 
        }
    </style>
</head>
<body>

<div class="admin-container">
    <header class="admin-header">
        <div>
            <h1>Painel de Controle</h1>
            <p style="font-size: 0.8rem; opacity: 0.8;">Gerenciamento de Comiss√µes e Vendas</p>
        </div>
        <button class="btn-pdf" onclick="gerarRelatorio()">
            üìÑ Gerar Extrato Quinzenal
        </button>
    </header>

    <div class="stats-grid">
        <div class="card">
            <h4>Vendas Brutas</h4>
            <p id="total-vendas">R$ 0,00</p>
        </div>
        <div class="card">
            <h4>Sua Comiss√£o (10%)</h4>
            <p id="total-comissao" class="highlight">R$ 0,00</p>
        </div>
        <div class="card">
            <h4>Taxa Fixa</h4>
            <p>R$ 59,90</p>
        </div>
        <div class="card">
            <h4>Total a Receber</h4>
            <p id="total-receber" style="color: var(--success);">R$ 0,00</p>
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Pedido</th>
                    <th>Valor do Pedido</th>
                    <th>Sua Parte (10%)</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody id="tabela-corpo">
                </tbody>
        </table>
    </div>
</div>

<script>
    // Dados de exemplo (isso vir√° do seu banco de dados no futuro)
    const pedidos = [
        { data: "20/05/2024 19:30", item: "2x X-Salada, 1x Coca 2L", valor: 85.00 },
        { data: "20/05/2024 20:15", item: "1x Pizza G (Meio a Meio)", valor: 65.00 },
        { data: "21/05/2024 12:00", item: "3x Marmitex Executiva", valor: 90.00 },
        { data: "21/05/2024 21:10", item: "1x Combo Casal", valor: 120.00 }
    ];

    const TAXA_FIXA = 59.90;

    function carregarPainel() {
        const corpo = document.getElementById("tabela-corpo");
        let somaVendas = 0;

        pedidos.forEach(p => {
            somaVendas += p.valor;
            const row = `<tr>
                <td>${p.data}</td>
                <td>${p.item}</td>
                <td>R$ ${p.valor.toFixed(2)}</td>
                <td>R$ ${(p.valor * 0.1).toFixed(2)}</td>
                <td><span class="status-badge">Registrado</span></td>
            </tr>`;
            corpo.innerHTML += row;
        });

        const comissao = somaVendas * 0.1;
        document.getElementById("total-vendas").innerText = `R$ ${somaVendas.toFixed(2)}`;
        document.getElementById("total-comissao").innerText = `R$ ${comissao.toFixed(2)}`;
        document.getElementById("total-receber").innerText = `R$ ${(comissao + TAXA_FIXA).toFixed(2)}`;
    }

    function gerarRelatorio() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        doc.setFontSize(20);
        doc.text("Extrato de Cobran√ßa - Sistema Delivery", 20, 20);
        
        doc.setFontSize(12);
        doc.text("Per√≠odo: 15/05/2024 a 30/05/2024", 20, 30);
        doc.text("Loja: Hamburgueria do Cliente", 20, 37);

        // Criar a tabela no PDF usando o plugin autoTable
        const colunas = ["Data", "Pedido", "Valor", "10%"];
        const linhas = pedidos.map(p => [p.data, p.item, `R$ ${p.valor.toFixed(2)}`, `R$ ${(p.valor * 0.1).toFixed(2)}`]);

        doc.autoTable({
            startY: 45,
            head: [colunas],
            body: linhas,
            theme: 'grid'
        });

        const finalY = doc.lastAutoTable.finalY + 10;
        const comissaoTotal = pedidos.reduce((acc, p) => acc + (p.valor * 0.1), 0);

        doc.setFont("helvetica", "bold");
        doc.text(`Subtotal Comiss√µes: R$ ${comissaoTotal.toFixed(2)}`, 20, finalY);
        doc.text(`Taxa Fixa Mensal: R$ ${TAXA_FIXA.toFixed(2)}`, 20, finalY + 10);
        doc.setFontSize(16);
        doc.setTextColor(230, 126, 34); // Cor Laranja
        doc.text(`TOTAL A PAGAR: R$ ${(comissaoTotal + TAXA_FIXA).toFixed(2)}`, 20, finalY + 25);

        doc.save("extrato-cobranca.pdf");
    }

    carregarPainel();
</script>

</body>
</html>
